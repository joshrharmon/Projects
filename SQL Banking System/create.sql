-- Connect to database
CONNECT TO cs157a

-- Create tables

-- Customer Table
CREATE TABLE p1.customer (id INT NOT NULL GENERATED BY DEFAULT AS IDENTITY (START WITH 100, INCREMENT BY 1), name VARCHAR(15) NOT NULL, gender CHAR(1) NOT NULL CHECK (gender='M' OR gender='F'), age INTEGER NOT NULL CHECK (age >= 0), pin INTEGER NOT NULL CHECK (pin >= 0), PRIMARY KEY (id))

-- Account Table
CREATE TABLE p1.account (NUMBER INTEGER NOT NULL GENERATED ALWAYS AS IDENTITY (START WITH 1000, INCREMENT BY 1), id INT NOT NULL CHECK (id >= 100), balance INTEGER NOT NULL CHECK (balance >= 0), type CHAR(1) NOT NULL CHECK (type='C' OR type='S'), status CHAR(1) NOT NULL CHECK (status='A' OR status='I'), PRIMARY KEY (number))

-- Report A View
CREATE VIEW REPORTA(ID, NAME, AGE, GENDER, TOTALBAL) AS SELECT P1.CUSTOMER.ID, NAME, AGE, GENDER, SUM(BALANCE) AS totalbal FROM P1.CUSTOMER FULL OUTER JOIN P1.ACCOUNT ON P1.CUSTOMER.ID=P1.ACCOUNT.ID GROUP BY NAME,GENDER,AGE,P1.CUSTOMER.ID

-- Report B View
CREATE VIEW REPORTB(AGE, BALANCE) AS SELECT AGE,BALANCE FROM P1.CUSTOMER JOIN P1.ACCOUNT ON P1.CUSTOMER.ID=P1.ACCOUNT.ID WHERE STATUS != 'I'

TERMINATE